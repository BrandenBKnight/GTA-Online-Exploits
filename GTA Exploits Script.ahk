#NoEnv
#Warn
SendMode Input
SetWorkingDir %A_ScriptDir%
#Persistent
#SingleInstance force
ListLines Off
SetKeyDelay -1,-1
SetWinDelay -1
SetBatchLines -1
SetControlDelay -1
SetTitleMatchMode, 2
if not A_IsAdmin
	Run *RunAs "%A_ScriptFullPath%"
OnExit("AppExit")

!+f4::ExitApp

^F1::
	RunWait netsh advfirewall firewall add rule name="GTA V No Save Mode" dir=out action=block remoteip="192.81.241.171" ,,hide
	ToolTip, NO SAVE MODE ON, 10, 10
	Sleep 3000
	ToolTip, NO SAVE MODE ON, 10, 10
	Return

^F2::
	RunWait netsh advfirewall firewall delete rule name="GTA V No Save Mode" ,,hide
	ToolTip, NO SAVE MODE OFF, 10, 10,
	Sleep 3000
	Tooltip, , 0, 0
	Return

^F3::
	RunWait netsh advfirewall firewall add rule name="GTA V Network Block Mode" dir=out action=block ,,hide
	RunWait  netsh advfirewall firewall add rule name="GTA V Network Block Mode" dir=in action=block ,,hide
	ToolTip, NETWORK BLOCK MODE ON, 0, 0
	Sleep 3000
	Tooltip, NETWORK BLOCK MODE ON, 0, 0
	Return

^F4::
	RunWait  netsh advfirewall firewall delete rule name="GTA V Network Block Mode" ,,hide
	ToolTip, NETWORK BLOCK MODE OFF, 0, 0
	Sleep 3000
	Tooltip, , 0, 0
	Return

^F5::
    Loop
    {
	  ToolTip, Auto Lucky Wheel Spin is Running, 0, 0
        PixelGetColor, color, 125, 50, RGB
        If (color = 0xFFFFFF)
        {
		ToolTip, Waiting 2.7 Seconds, 0, 0
		Sleep 2750
		SendInput {s down}
		Sleep 500
		SendInput {s up}
		ToolTip, , 0, 0
            Break
        }
    }
    Return

^F6::
	ToolTip, ., 125,50
	Sleep 3000
	Tooltip, , 0, 0
	Return

^Numpad0::
	RunWait netsh advfirewall firewall add rule name="GTA V Network Block Mode" dir=out action=block ,,hide
	RunWait  netsh advfirewall firewall add rule name="GTA V Network Block Mode" dir=in action=block ,,hide
	ToolTip, NETWORK BLOCK MODE ON, 0, 0
	Process, Close, GTA5.exe
	Process, Close, Launcher.exe
	ToolTip, Killing GTA V Process, 0,0
	Sleep 3000
	RunWait  netsh advfirewall firewall delete rule name="GTA V Network Block Mode" ,,hide
	ToolTip, Restoring Internet Connection, 0, 0
	Sleep 3000
	Tooltip, , 0, 0
	Return

^F12::
	Tooltip,
	(
Macro List	
	CTRL + F1 - Enable No Save Mode
	CTRL + F2 - Disable No Save Mode
	CTRL + F3 - Enable Network Block Mode
	CTRL + F4 - Disable Network Block Mode
	CTRL + F5 - Auto Spin Lucky Wheel
	CTRL + F6 - Check Auto Spin Configuration
	CTRL + Numpad0 Instant Quit + Disconnect/Reconnect
	CTRL + F12 - Display Help Text
	
	), 0, 0
	Sleep 10000
	Tooltip, , 0, 0
	Return



;scripts
AppExit()
{
	RunWait netsh advfirewall firewall delete rule name="GTA V Network Block Mode" ,,hide
	RunWait netsh advfirewall firewall delete rule name="GTA V No Save Mode" ,,hide
}
